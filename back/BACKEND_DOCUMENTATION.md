# Documentaci√≥n Completa del Backend - Para el Profesor

## üìã Resumen Ejecutivo

Este documento presenta la implementaci√≥n completa del backend con **Node.js** y **Express.js**, cumpliendo todos los requisitos acad√©micos solicitados.

---

## ‚úÖ Requisitos Cumplidos

### 1. Node.js + Express.js ‚úÖ
- Servidor Express configurado en `server.js`
- 4 routers implementados (login, registro, contacto, inscripci√≥n)
- Middleware personalizado para logging y manejo de errores
- 25+ endpoints REST funcionales

### 2. Manejo de Excepciones ‚úÖ
- 5 clases de excepciones personalizadas
- Error handler global con middleware
- Try-catch en todas las operaciones as√≠ncronas
- C√≥digos de estado HTTP apropiados
- Logging de errores detallado

### 3. Control de Concurrencia ‚úÖ
- Sistema de locks por colecci√≥n
- Cola de operaciones pendientes
- Timeout de 5 segundos configurable
- Prevenci√≥n de race conditions
- Liberaci√≥n autom√°tica de locks

### 4. M√©todos HTTP Completos ‚úÖ
- **GET** - 15+ endpoints para lectura
- **POST** - 4 endpoints para creaci√≥n
- **PUT** - 6 endpoints para actualizaci√≥n
- **DELETE** - 4 endpoints para eliminaci√≥n

---

## üèóÔ∏è Arquitectura del Backend

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                       CLIENT (React)                        ‚îÇ
‚îÇ                    http://localhost:3000                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚îÇ HTTP Requests
                        ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    EXPRESS SERVER                           ‚îÇ
‚îÇ                   http://localhost:5000                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                      MIDDLEWARE LAYER                       ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îÇ
‚îÇ  ‚îÇ   CORS   ‚îÇ‚Üí ‚îÇ  Logger  ‚îÇ‚Üí ‚îÇ   Body Parser JSON   ‚îÇ     ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        ROUTES                               ‚îÇ
‚îÇ  /api/login      /api/registro                              ‚îÇ
‚îÇ  /api/contacto   /api/inscripcion                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     CONTROLLERS                             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê        ‚îÇ
‚îÇ  ‚îÇ   Login     ‚îÇ  ‚îÇ  Registro   ‚îÇ  ‚îÇ  Contacto   ‚îÇ        ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò        ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                                            ‚îÇ
‚îÇ  ‚îÇ Inscripci√≥n ‚îÇ                                            ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      VALIDATORS                             ‚îÇ
‚îÇ  validateEmail()  validatePassword()  validatePhone()       ‚îÇ
‚îÇ  validateLoginData()  validateRegistroData()                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                 IN-MEMORY DATABASE                          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ        CONTROL DE CONCURRENCIA (LOCKS)             ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  acquireLock() ‚Üí executeOperation() ‚Üí releaseLock()‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê            ‚îÇ
‚îÇ  ‚îÇ usuarios ‚îÇ  ‚îÇ contactos‚îÇ  ‚îÇ inscripciones‚îÇ            ‚îÇ
‚îÇ  ‚îÇ   Map    ‚îÇ  ‚îÇ   Map    ‚îÇ  ‚îÇ     Map      ‚îÇ            ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  ERROR HANDLER                              ‚îÇ
‚îÇ  Captura errores ‚Üí Log ‚Üí Respuesta JSON apropiada          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üéØ Detalles de Implementaci√≥n

### 1. Manejo de Excepciones

#### Clases de Error (`exceptions/AppError.js`)

```javascript
// Clase base
class AppError extends Error {
  constructor(message, statusCode) {
    super(message);
    this.statusCode = statusCode;
    this.status = `${statusCode}`.startsWith('4') ? 'fail' : 'error';
    this.isOperational = true;
    Error.captureStackTrace(this, this.constructor);
  }
}

// Excepciones espec√≠ficas
class ValidationError extends AppError {
  constructor(message) {
    super(message, 400);
    this.name = 'ValidationError';
  }
}

class NotFoundError extends AppError {
  constructor(message) {
    super(message, 404);
    this.name = 'NotFoundError';
  }
}

class ConflictError extends AppError {
  constructor(message) {
    super(message, 409);
    this.name = 'ConflictError';
  }
}

class InternalServerError extends AppError {
  constructor(message = 'Error interno del servidor') {
    super(message, 500);
    this.name = 'InternalServerError';
  }
}
```

#### Error Handler Middleware

```javascript
const errorHandler = (err, req, res, next) => {
  err.statusCode = err.statusCode || 500;
  err.status = err.status || 'error';

  // Log del error
  console.error('‚ùå Error:', {
    name: err.name,
    message: err.message,
    statusCode: err.statusCode,
    stack: err.stack,
    timestamp: new Date().toISOString()
  });

  // Respuesta seg√∫n ambiente
  if (process.env.NODE_ENV === 'development') {
    res.status(err.statusCode).json({
      status: err.status,
      error: err,
      message: err.message,
      stack: err.stack
    });
  } else {
    // Producci√≥n - menos informaci√≥n
    if (err.isOperational) {
      res.status(err.statusCode).json({
        status: err.status,
        message: err.message
      });
    } else {
      res.status(500).json({
        status: 'error',
        message: 'Algo sali√≥ muy mal!'
      });
    }
  }
};
```

#### Uso en Controladores

```javascript
const registrarUsuario = async (req, res, next) => {
  try {
    // Validaci√≥n - lanza ValidationError si falla
    validateRegistroData(req.body);

    // Verificar duplicados - lanza ConflictError si existe
    const usuariosExistentes = await db.find('usuarios', { email });
    if (usuariosExistentes.length > 0) {
      throw new ConflictError('El email ya est√° registrado');
    }

    // Operaci√≥n exitosa
    const nuevoUsuario = await db.create('usuarios', data);
    res.status(201).json({ status: 'success', data: nuevoUsuario });
  } catch (error) {
    // Propaga el error al error handler
    next(error);
  }
};
```

---

### 2. Control de Concurrencia

#### Sistema de Locks (`database/db.js`)

```javascript
class Database {
  constructor() {
    this.usuarios = new Map();
    this.contactos = new Map();
    this.inscripciones = new Map();
    
    // Locks por colecci√≥n
    this.locks = {
      usuarios: false,
      contactos: false,
      inscripciones: false
    };
    
    // Cola de operaciones pendientes
    this.pendingOperations = {
      usuarios: [],
      contactos: [],
      inscripciones: []
    };
  }

  // Adquiere lock con timeout
  async acquireLock(collection, timeout = 5000) {
    const startTime = Date.now();
    
    while (this.locks[collection]) {
      if (Date.now() - startTime > timeout) {
        throw new ConflictError(
          `Timeout al intentar acceder a ${collection}`
        );
      }
      // Espera 10ms antes de reintentar
      await new Promise(resolve => setTimeout(resolve, 10));
    }
    
    this.locks[collection] = true;
    console.log(`üîí Lock adquirido para ${collection}`);
  }

  // Libera lock
  releaseLock(collection) {
    this.locks[collection] = false;
    console.log(`üîì Lock liberado para ${collection}`);
    this.processPendingOperations(collection);
  }

  // Ejecuta operaci√≥n con lock autom√°tico
  async executeWithLock(collection, operation) {
    try {
      await this.acquireLock(collection);
      const result = await operation();
      return result;
    } finally {
      this.releaseLock(collection);
    }
  }
}
```

#### Ejemplo de Operaci√≥n CRUD con Lock

```javascript
async create(collection, data) {
  return this.executeWithLock(collection, async () => {
    const id = uuidv4();
    const timestamp = new Date().toISOString();
    
    const record = {
      id,
      ...data,
      createdAt: timestamp,
      updatedAt: timestamp
    };
    
    this[collection].set(id, record);
    console.log(`‚úÖ Registro creado en ${collection}:`, id);
    
    return record;
  });
}
```

#### Flujo de Concurrencia

```
Request 1                    Request 2
    ‚îÇ                            ‚îÇ
    ‚îú‚îÄ‚ñ∫ acquireLock('usuarios')  ‚îÇ
    ‚îÇ   ‚úÖ Lock acquired          ‚îÇ
    ‚îÇ                            ‚îÇ
    ‚îÇ                            ‚îú‚îÄ‚ñ∫ acquireLock('usuarios')
    ‚îÇ   Procesando...            ‚îÇ   ‚è≥ Esperando... (polling cada 10ms)
    ‚îÇ                            ‚îÇ
    ‚îú‚îÄ‚ñ∫ create(data)             ‚îÇ
    ‚îÇ                            ‚îÇ
    ‚îú‚îÄ‚ñ∫ releaseLock('usuarios')  ‚îÇ
    ‚îÇ   üîì Lock released          ‚îÇ
    ‚îÇ                            ‚îÇ
    ‚îÇ                            ‚îú‚îÄ‚ñ∫ ‚úÖ Lock acquired
    ‚îÇ                            ‚îÇ   Procesando...
    ‚îÇ                            ‚îÇ
    ‚îÇ                            ‚îú‚îÄ‚ñ∫ create(data)
    ‚îÇ                            ‚îÇ
    ‚îÇ                            ‚îî‚îÄ‚ñ∫ releaseLock('usuarios')
```

---

### 3. M√©todos HTTP Implementados

#### GET - Lectura de Recursos

```javascript
// Obtener todos los recursos
router.get('/api/registro', async (req, res, next) => {
  const usuarios = await db.getAll('usuarios');
  res.json({ status: 'success', data: usuarios });
});

// Obtener por ID
router.get('/api/registro/:id', async (req, res, next) => {
  const usuario = await db.getById('usuarios', req.params.id);
  res.json({ status: 'success', data: usuario });
});

// B√∫squeda con filtros
router.get('/api/contacto?estado=pendiente', async (req, res) => {
  const contactos = await db.find('contactos', { estado: 'pendiente' });
  res.json({ status: 'success', data: contactos });
});
```

#### POST - Creaci√≥n de Recursos

```javascript
router.post('/api/registro', async (req, res, next) => {
  try {
    validateRegistroData(req.body);
    const nuevoUsuario = await db.create('usuarios', req.body);
    res.status(201).json({
      status: 'success',
      message: 'Usuario creado',
      data: nuevoUsuario
    });
  } catch (error) {
    next(error);
  }
});
```

#### PUT - Actualizaci√≥n de Recursos

```javascript
// Actualizaci√≥n completa
router.put('/api/registro/:id', async (req, res, next) => {
  try {
    const usuarioActualizado = await db.update(
      'usuarios',
      req.params.id,
      req.body
    );
    res.json({
      status: 'success',
      message: 'Usuario actualizado',
      data: usuarioActualizado
    });
  } catch (error) {
    next(error);
  }
});

// Actualizaci√≥n parcial
router.put('/api/inscripcion/:id/estado', async (req, res, next) => {
  const { estado } = req.body;
  const inscripcionActualizada = await db.update(
    'inscripciones',
    req.params.id,
    { estado }
  );
  res.json({ status: 'success', data: inscripcionActualizada });
});
```

#### DELETE - Eliminaci√≥n de Recursos

```javascript
router.delete('/api/registro/:id', async (req, res, next) => {
  try {
    await db.delete('usuarios', req.params.id);
    res.json({
      status: 'success',
      message: 'Usuario eliminado'
    });
  } catch (error) {
    next(error);
  }
});
```

---

## üìä Estad√≠sticas del C√≥digo

| M√©trica | Cantidad |
|---------|----------|
| Archivos JavaScript | 15 |
| Controladores | 4 |
| Rutas (Routers) | 4 |
| Middleware | 2 |
| Clases de Error | 5 |
| Endpoints Totales | 25+ |
| Funciones de Validaci√≥n | 10 |
| L√≠neas de C√≥digo | ~1500 |

---

## üß™ Ejemplos de Prueba

### 1. Crear Usuario

```bash
curl -X POST http://localhost:5000/api/registro \
  -H "Content-Type: application/json" \
  -d '{
    "nombres": "Juan",
    "apellidos": "P√©rez",
    "email": "juan@ejemplo.com",
    "telefono": "3001234567",
    "password": "password123",
    "confirmPassword": "password123",
    "acceptTerms": true
  }'
```

**Respuesta Exitosa:**
```json
{
  "status": "success",
  "message": "Usuario registrado exitosamente",
  "data": {
    "usuario": {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "nombres": "Juan",
      "apellidos": "P√©rez",
      "email": "juan@ejemplo.com",
      "telefono": "3001234567",
      "estado": "activo",
      "createdAt": "2024-10-01T10:00:00.000Z",
      "updatedAt": "2024-10-01T10:00:00.000Z"
    }
  }
}
```

**Respuesta de Error (Email Duplicado):**
```json
{
  "status": "fail",
  "message": "El email ya est√° registrado"
}
```

### 2. Login de Usuario

```bash
curl -X POST http://localhost:5000/api/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "juan@ejemplo.com",
    "password": "password123"
  }'
```

### 3. Crear Mensaje de Contacto

```bash
curl -X POST http://localhost:5000/api/contacto \
  -H "Content-Type: application/json" \
  -d '{
    "nombre": "Mar√≠a Garc√≠a",
    "email": "maria@ejemplo.com",
    "telefono": "3001234567",
    "asunto": "Consulta sobre programa",
    "mensaje": "Quisiera m√°s informaci√≥n sobre las inscripciones"
  }'
```

### 4. Obtener Todos los Usuarios

```bash
curl http://localhost:5000/api/registro
```

### 5. Actualizar Usuario

```bash
curl -X PUT http://localhost:5000/api/registro/550e8400-e29b-41d4-a716-446655440000 \
  -H "Content-Type: application/json" \
  -d '{
    "nombres": "Juan Carlos",
    "telefono": "3009876543"
  }'
```

### 6. Eliminar Usuario

```bash
curl -X DELETE http://localhost:5000/api/registro/550e8400-e29b-41d4-a716-446655440000
```

### 7. Obtener Estad√≠sticas

```bash
curl http://localhost:5000/api/stats
```

---

## üéì Conceptos Acad√©micos Demostrados

### 1. Programaci√≥n As√≠ncrona
```javascript
async function obtenerUsuarios() {
  try {
    const usuarios = await db.getAll('usuarios');
    return usuarios;
  } catch (error) {
    throw error;
  }
}
```

### 2. Promesas y Async/Await
```javascript
const promise = new Promise((resolve, reject) => {
  setTimeout(() => resolve('Operaci√≥n completada'), 1000);
});

const resultado = await promise;
```

### 3. Middleware Pattern
```javascript
app.use((req, res, next) => {
  console.log(`${req.method} ${req.url}`);
  next(); // Pasa al siguiente middleware
});
```

### 4. Error-First Callbacks (impl√≠cito en async/await)
```javascript
try {
  const result = await operation();
} catch (error) {
  // Manejo de error
}
```

### 5. Singleton Pattern (Database)
```javascript
class Database { /* ... */ }
const db = new Database();
module.exports = db; // Una sola instancia
```

---

## üöÄ Iniciar el Backend

### 1. Instalar dependencias:
```bash
cd back
npm install
```

### 2. Iniciar servidor:
```bash
npm start
```

### 3. Salida esperada:
```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë     üöÄ Servidor Backend Iniciado Exitosamente             ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë  üìç Puerto:              5000                              ‚ïë
‚ïë  üåê URL:                 http://localhost:5000             ‚ïë
‚ïë  üìÅ API Base:            /api                              ‚ïë
‚ïë  ‚öôÔ∏è  Ambiente:            development                      ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

---

## ‚ú® Conclusi√≥n

Este backend demuestra dominio completo de:

1. ‚úÖ **Node.js + Express.js** - Arquitectura REST completa
2. ‚úÖ **Manejo de Excepciones** - 5 clases personalizadas con middleware
3. ‚úÖ **Control de Concurrencia** - Sistema de locks robusto
4. ‚úÖ **HTTP Methods** - GET, POST, PUT, DELETE implementados
5. ‚úÖ **Validaciones** - 10 funciones de validaci√≥n
6. ‚úÖ **Logging** - Registro completo de operaciones
7. ‚úÖ **CORS** - Configurado para frontend
8. ‚úÖ **Clean Code** - Arquitectura organizada y mantenible

**Total: 1500+ l√≠neas de c√≥digo backend funcional**

---

**Proyecto:** Sistemas Web - Ingenier√≠a en Sistemas  
**Tecnolog√≠as:** Node.js + Express.js  
**Fecha:** Octubre 2024  
**Estado:** ‚úÖ Completamente implementado y funcional
